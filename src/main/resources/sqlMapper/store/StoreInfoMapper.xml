<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.store.dao.store.StoreMapper">
    <resultMap id="baseResultMap" type="com.store.domain.StoreInfo">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="type" property="type" jdbcType="VARCHAR"/>
        <result column="mobile" property="mobile" jdbcType="VARCHAR"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="address" property="address" jdbcType="VARCHAR"/>
        <result column="location_x" property="locationX" jdbcType="VARCHAR"/>
        <result column="location_y" property="locationY" jdbcType="VARCHAR"/>
        <result column="logo_url" property="logoUrl" jdbcType="VARCHAR"/>
        <result column="logo_detail_url" property="logoDetailUrl" jdbcType="VARCHAR"/>
        <result column="description" property="description" jdbcType="VARCHAR"/>
        <result column="tags" property="tags" jdbcType="VARCHAR"/>
        <result column="order_id" property="orderId" jdbcType="VARCHAR"/>
        <result column="is_online" property="isOnline" jdbcType="VARCHAR"/>
        <result column="created_by" jdbcType="VARCHAR" property="createdBy" />
        <result column="created_date" jdbcType="TIMESTAMP" property="createdDate" />
        <result column="last_modified_by" jdbcType="VARCHAR" property="lastModifiedBy" />
        <result column="last_modified_date" jdbcType="TIMESTAMP" property="lastModifiedDate" />
        <result column="flag" jdbcType="BIT" property="flag" />
    </resultMap>
    <sql id="Base_Column_List">
        `id`,`type`, `mobile`, `name`, `address`, `location_x`, `location_y`,
        `logo_url`, `logo_detail_url`, `description`, `tags`, `order_id`,`is_online`,
        `created_date`,`last_modified_date`, `created_by`, `last_modified_by`, `flag`
    </sql>
    <select id="findStoreInfoCount" resultType="java.lang.Integer" parameterType="com.store.domain.StoreInfo">
        SELECT
          COUNT(*)
        FROM
        store_info
        WHERE flag=1
        <if test="storeInfo.id != null and storeInfo.id != 0">
            AND `id` = #{storeInfo.id}
        </if>
        <if test="storeInfo.type != null">
            AND `type` = #{storeInfo.type}
        </if>
        <if test="storeInfo.mobile != null">
            AND `mobile` = #{storeInfo.mobile}
        </if>
        <if test="storeInfo.name != null">
            AND `name` = #{storeInfo.name}
        </if>
        <if test="storeInfo.address != null">
            AND `address` = #{storeInfo.address}
        </if>
        <if test="storeInfo.locationX != null">
            AND `location_x` = #{storeInfo.locationX}
        </if>
        <if test="storeInfo.locationY != null">
            AND `location_y` = #{storeInfo.locationY}
        </if>
        <if test="storeInfo.isOnline != null">
            AND `is_online` = #{storeInfo.isOnline}
        </if>
        <if test="storeInfo.description != null">
            AND `description` like  concat('%', #{storeInfo.description}, '%')
        </if>
        <if test="storeInfo.tags != null">
            AND `tags` like concat('%', #{storeInfo.tags}, '%')
        </if>
        <if test="storeInfo.orderId != null">
            AND `order_id` = #{storeInfo.orderId}
        </if>
    </select>

    <select id="findStoreInfoPage" resultMap="baseResultMap" parameterType="com.store.domain.StoreInfo">
        SELECT
            <include refid="Base_Column_List"/>
        FROM
            store_info
        WHERE flag=1
            <if test="storeInfo.id != null and storeInfo.id != 0">
                AND `id` = #{storeInfo.id}
            </if>
            <if test="storeInfo.type != null">
                AND `type` = #{storeInfo.type}
            </if>
            <if test="storeInfo.mobile != null">
                AND `mobile` = #{storeInfo.mobile}
            </if>
            <if test="storeInfo.name != null">
                AND `name` like concat('%',#{storeInfo.name},'%')
            </if>
            <if test="storeInfo.address != null">
                AND `address` = #{storeInfo.address}
            </if>
            <if test="storeInfo.locationX != null">
                AND `location_x` = #{storeInfo.locationX}
            </if>
            <if test="storeInfo.locationY != null">
                AND `location_y` = #{storeInfo.locationY}
            </if>
            <if test="storeInfo.isOnline != null">
                <if test="storeInfo.isOnline == 'All'">

                </if>
                <if test="storeInfo.isOnline != 'All'">
                    AND `is_online` = #{storeInfo.isOnline}
                </if>
            </if>
            <if test="storeInfo.isOnline == null || storeInfo.isOnline == ''">
                AND `is_online` = 1
            </if>
            <if test="storeInfo.description != null">
                AND `description` like  concat('%', #{storeInfo.description}, '%')
            </if>
            <if test="storeInfo.tags != null">
                AND `tags` like concat('%', #{storeInfo.tags}, '%')
            </if>
            <if test="storeInfo.orderId != null">
                AND `order_id` = #{storeInfo.orderId}
            </if>
            Order By order_id
            limit #{page.offset},#{page.pageSize}
    </select>
    <select id="findOne" resultMap="baseResultMap" parameterType="com.store.domain.StoreInfo">
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        store_info
        WHERE flag=1
        <if test="storeInfo.id != null and storeInfo.id != 0">
            AND `id` = #{storeInfo.id}
        </if>
        <if test="storeInfo.type != null">
            AND `type` = #{storeInfo.type}
        </if>
        <if test="storeInfo.mobile != null">
            AND `mobile` = #{storeInfo.mobile}
        </if>
        <if test="storeInfo.name != null">
            AND `name` like concat('%',#{storeInfo.name},'%')
        </if>
        <if test="storeInfo.address != null">
            AND `address` = #{storeInfo.address}
        </if>
        <if test="storeInfo.locationX != null">
            AND `location_x` = #{storeInfo.locationX}
        </if>
        <if test="storeInfo.locationY != null">
            AND `location_y` = #{storeInfo.locationY}
        </if>
        <if test="storeInfo.isOnline != null">
            <if test="storeInfo.isOnline == 'All'">

            </if>
            <if test="storeInfo.isOnline != 'All'">
                AND `is_online` = #{storeInfo.isOnline}
            </if>
        </if>
        <if test="storeInfo.isOnline == null || storeInfo.isOnline == ''">
            AND `is_online` = 1
        </if>
        <if test="storeInfo.description != null">
            AND `description` like  concat('%', #{storeInfo.description}, '%')
        </if>
        <if test="storeInfo.tags != null">
            AND `tags` like concat('%', #{storeInfo.tags}, '%')
        </if>
        <if test="storeInfo.orderId != null">
            AND `order_id` = #{storeInfo.orderId}
        </if>
        Order By order_id
        limit 1
    </select>
    <update id="updateStoreInfo" parameterType="com.store.domain.StoreInfo">
        update store_info
        <set>
            <if test="storeInfo.type != null">
                `type` = #{storeInfo.type},
            </if>
            <if test="storeInfo.mobile != null">
                `mobile` = #{storeInfo.mobile},
            </if>
            <if test="storeInfo.name != null">
               `name` = #{storeInfo.name},
            </if>
            <if test="storeInfo.address != null">
               `address` = #{storeInfo.address},
            </if>
            <if test="storeInfo.locationX != null">
                 `location_x` = #{storeInfo.locationX},
            </if>
            <if test="storeInfo.locationY != null">
               `location_y` = #{storeInfo.locationY},
            </if>
            <if test="storeInfo.isOnline != null">
               `is_online` = #{storeInfo.isOnline},
            </if>
            <if test="storeInfo.description != null">
                `description`= #{storeInfo.description} ,
            </if>
            <if test="storeInfo.tags != null">
                `tags`  = #{storeInfo.tags} ,
            </if>
            <if test="storeInfo.logoUrl != null">
                `logo_url`  = #{storeInfo.logoUrl} ,
            </if>
            <if test="storeInfo.logoDetailUrl != null">
                `logo_detail_url`  = #{storeInfo.logoDetailUrl} ,
            </if>
        </set>
        where id = #{storeInfo.id}
    </update>
    <insert id="addStoreInfo" parameterType="com.store.domain.StoreInfo">
        insert into store_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="storeInfo.type != null">
                `type`,
            </if>
            <if test="storeInfo.mobile != null">
                `mobile`,
            </if>
            <if test="storeInfo.name != null">
                `name`,
            </if>
            <if test="storeInfo.address != null">
                `address`,
            </if>
            <if test="storeInfo.locationX != null">
                `location_x`,
            </if>
            <if test="storeInfo.locationY != null">
                `location_y`,
            </if>
            <if test="storeInfo.isOnline != null">
                `is_online`,
            </if>
            <if test="storeInfo.description != null">
                `description`,
            </if>
            <if test="storeInfo.tags != null">
                `tags`,
            </if>
            <if test="storeInfo.logoUrl != null">
                `logo_url` ,
            </if>
            <if test="storeInfo.logoDetailUrl != null">
                `logo_detail_url` ,
            </if>
            <if test="storeInfo.orderId != null">
                `order_id` ,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="storeInfo.type != null">
                #{storeInfo.type},
            </if>
            <if test="storeInfo.mobile != null">
                #{storeInfo.mobile},
            </if>
            <if test="storeInfo.name != null">
                #{storeInfo.name},
            </if>
            <if test="storeInfo.address != null">
                 #{storeInfo.address},
            </if>
            <if test="storeInfo.locationX != null">
                #{storeInfo.locationX},
            </if>
            <if test="storeInfo.locationY != null">
                #{storeInfo.locationY},
            </if>
            <if test="storeInfo.isOnline != null">
                #{storeInfo.isOnline},
            </if>
            <if test="storeInfo.description != null">
                #{storeInfo.description} ,
            </if>
            <if test="storeInfo.tags != null">
                #{storeInfo.tags} ,
            </if>
            <if test="storeInfo.logoUrl != null">
                #{storeInfo.logoUrl} ,
            </if>
            <if test="storeInfo.logoDetailUrl != null">
                #{storeInfo.logoDetailUrl} ,
            </if>
            <if test="storeInfo.orderId != null">
                #{storeInfo.orderId} ,
            </if>

        </trim>
    </insert>
</mapper>